"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@xdoer/x");exports.default=class{constructor(s){this.opt=s,this.on=!1;const{promise:t,resolve:r}=new e.AsyncPromise;this.promise=t,this.resolvePromise=r}async getValue(){return this.opt.getValue()}async setValue(e){return this.opt.setValue(e)}async clear(){if(this.on)return;const{promise:s,resolve:t}=new e.AsyncPromise;return this.promise=s,this.resolvePromise=t,this.opt.clearValue()}static createLockWrapper(e){return async function(s){if(e.on)return e.promise;e.on=!0;const t=await e.getValue()||await s();return await e.setValue(t),e.on=!1,e.resolvePromise(t),t}}};
//# sourceMappingURL=lock.cjs.production.min.js.map
