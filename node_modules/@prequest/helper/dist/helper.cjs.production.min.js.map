{"version":3,"file":"helper.cjs.production.min.js","sources":["../src/error.ts","../src/index.ts"],"sourcesContent":["import { Config } from '@prequest/types'\n\ninterface PQErrorOptions {\n  code: ErrorCode\n  config: Config\n}\n\nexport class PQError extends Error {\n  code?: ErrorCode\n  config?: Config\n\n  constructor(private opt?: Partial<PQErrorOptions>) {\n    super()\n    const { code, config } = this.opt || {}\n    this.code = code\n    this.config = config\n  }\n}\n\nexport enum ErrorCode {\n  timeout = 'timeout',\n  abort = 'abort',\n  common = 'common',\n}\n\nexport function createError(code: ErrorCode, message: string, opt: Config) {\n  const error = new Error(message)\n  return enhanceError(error, code, opt)\n}\n\nexport function enhanceError(error: PQError, code: ErrorCode, opt: Config) {\n  error.code = code\n  error.config = opt\n\n  return error\n}\n","import { stringify } from 'qs'\nimport { isAbsoluteURL, isEmpty } from '@xdoer/x'\nimport { PresetOption, Common, PQRequest } from '@prequest/types'\n\nexport * from './error'\n\nexport const baseOption: PresetOption = {\n  path: '/',\n  method: 'GET',\n}\n\nexport function createRequestUrl<\n  T extends { baseURL?: string; path: string; url?: string; params?: Common }\n>(req: T): string {\n  const { baseURL, path, params } = req\n\n  let url = req.url || ''\n\n  if (isAbsoluteURL(path)) {\n    url += path\n  } else {\n    if (baseURL) url += baseURL\n    if (path) url += path\n  }\n\n  if (params && !isEmpty(params)) url += `?${stringify(params)}`\n\n  return url\n}\n\nexport function requestId(options: PQRequest): string {\n  return createRequestUrl({ ...options, params: {} })\n}\n"],"names":["ErrorCode","PQError","Error","constructor","opt","code","config","this","enhanceError","error","createRequestUrl","req","baseURL","path","params","url","isAbsoluteURL","isEmpty","stringify","method","message","options"],"mappings":"wEAmBYA,8CAZCC,UAAgBC,MAI3BC,YAAoBC,oBAAAA,QAEZC,KAAEA,EAAFC,OAAQA,GAAWC,KAAKH,KAAO,QAChCC,KAAOA,OACPC,OAASA,YAeFE,EAAaC,EAAgBJ,EAAiBD,UAC5DK,EAAMJ,KAAOA,EACbI,EAAMH,OAASF,EAERK,WCvBOC,EAEdC,SACMC,QAAEA,EAAFC,KAAWA,EAAXC,OAAiBA,GAAWH,MAE9BI,EAAMJ,EAAII,KAAO,UAEjBC,gBAAcH,GAChBE,GAAOF,GAEHD,IAASG,GAAOH,GAChBC,IAAME,GAAOF,IAGfC,IAAWG,UAAQH,KAASC,OAAWG,YAAUJ,IAE9CC,GDRGf,EAAAA,oBAAAA,yCAEVA,gBACAA,uDChBsC,CACtCa,KAAM,IACNM,OAAQ,oCDiBkBd,EAAiBe,EAAiBhB,UAErDI,EADO,IAAIN,MAAMkB,GACGf,EAAMD,iFCGTiB,UACjBX,EAAiB,IAAKW,EAASP,OAAQ"}