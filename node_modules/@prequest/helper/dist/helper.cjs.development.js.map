{"version":3,"file":"helper.cjs.development.js","sources":["../src/error.ts","../src/index.ts"],"sourcesContent":["import { Config } from '@prequest/types'\n\ninterface PQErrorOptions {\n  code: ErrorCode\n  config: Config\n}\n\nexport class PQError extends Error {\n  code?: ErrorCode\n  config?: Config\n\n  constructor(private opt?: Partial<PQErrorOptions>) {\n    super()\n    const { code, config } = this.opt || {}\n    this.code = code\n    this.config = config\n  }\n}\n\nexport enum ErrorCode {\n  timeout = 'timeout',\n  abort = 'abort',\n  common = 'common',\n}\n\nexport function createError(code: ErrorCode, message: string, opt: Config) {\n  const error = new Error(message)\n  return enhanceError(error, code, opt)\n}\n\nexport function enhanceError(error: PQError, code: ErrorCode, opt: Config) {\n  error.code = code\n  error.config = opt\n\n  return error\n}\n","import { stringify } from 'qs'\nimport { isAbsoluteURL, isEmpty } from '@xdoer/x'\nimport { PresetOption, Common, PQRequest } from '@prequest/types'\n\nexport * from './error'\n\nexport const baseOption: PresetOption = {\n  path: '/',\n  method: 'GET',\n}\n\nexport function createRequestUrl<\n  T extends { baseURL?: string; path: string; url?: string; params?: Common }\n>(req: T): string {\n  const { baseURL, path, params } = req\n\n  let url = req.url || ''\n\n  if (isAbsoluteURL(path)) {\n    url += path\n  } else {\n    if (baseURL) url += baseURL\n    if (path) url += path\n  }\n\n  if (params && !isEmpty(params)) url += `?${stringify(params)}`\n\n  return url\n}\n\nexport function requestId(options: PQRequest): string {\n  return createRequestUrl({ ...options, params: {} })\n}\n"],"names":["PQError","Error","constructor","opt","code","config","ErrorCode","createError","message","error","enhanceError","baseOption","path","method","createRequestUrl","req","baseURL","params","url","isAbsoluteURL","isEmpty","stringify","requestId","options"],"mappings":";;;;;;;MAOaA,gBAAgBC;AAI3BC,EAAAA,YAAoBC;AAClB;AADkB,YAAA,GAAAA,GAAA;AAElB,UAAM;AAAEC,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAmB,KAAKF,GAAL,IAAY,EAArC;AACA,SAAKC,IAAL,GAAYA,IAAZ;AACA,SAAKC,MAAL,GAAcA,MAAd;AACD;;;;AAGH,WAAYC;AACVA,EAAAA,oBAAA,YAAA;AACAA,EAAAA,kBAAA,UAAA;AACAA,EAAAA,mBAAA,WAAA;AACD,CAJD,EAAYA,iBAAS,KAATA,iBAAS,KAAA,CAArB;;SAMgBC,YAAYH,MAAiBI,SAAiBL;AAC5D,QAAMM,KAAK,GAAG,IAAIR,KAAJ,CAAUO,OAAV,CAAd;AACA,SAAOE,YAAY,CAACD,KAAD,EAAQL,IAAR,EAAcD,GAAd,CAAnB;AACD;SAEeO,aAAaD,OAAgBL,MAAiBD;AAC5DM,EAAAA,KAAK,CAACL,IAAN,GAAaA,IAAb;AACAK,EAAAA,KAAK,CAACJ,MAAN,GAAeF,GAAf;AAEA,SAAOM,KAAP;AACD;;MC7BYE,UAAU,GAAiB;AACtCC,EAAAA,IAAI,EAAE,GADgC;AAEtCC,EAAAA,MAAM,EAAE;AAF8B,CAAjC;AAKP,SAAgBC,iBAEdC;AACA,QAAM;AAAEC,IAAAA,OAAF;AAAWJ,IAAAA,IAAX;AAAiBK,IAAAA;AAAjB,MAA4BF,GAAlC;AAEA,MAAIG,GAAG,GAAGH,GAAG,CAACG,GAAJ,IAAW,EAArB;;AAEA,MAAIC,eAAa,CAACP,IAAD,CAAjB,EAAyB;AACvBM,IAAAA,GAAG,IAAIN,IAAP;AACD,GAFD,MAEO;AACL,QAAII,OAAJ,EAAaE,GAAG,IAAIF,OAAP;AACb,QAAIJ,IAAJ,EAAUM,GAAG,IAAIN,IAAP;AACX;;AAED,MAAIK,MAAM,IAAI,CAACG,SAAO,CAACH,MAAD,CAAtB,EAAgCC,GAAG,QAAQG,YAAS,CAACJ,MAAD,GAApB;AAEhC,SAAOC,GAAP;AACD;AAED,SAAgBI,UAAUC;AACxB,SAAOT,gBAAgB,CAAC,EAAE,GAAGS,OAAL;AAAcN,IAAAA,MAAM,EAAE;AAAtB,GAAD,CAAvB;AACD;;;;;;;;;"}